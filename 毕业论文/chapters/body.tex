
%=======第二章=================================
\newpage

\chapter{不确定图中最优生成树和次优生成树求解算法}
\vskip 0.3cm

\section{问题定义}
\label{sec:chap2definition}

\begin{definition}[不确定图]
\label{def:2.1}
不确定图是一个四元组$\mathcal{G} = (V, E, W, P)$，
其中$V$是顶点集，$E$是边集，
$W = \{w(e) \,|\,  e \in E, w(e) \in  \mathbb{N}^{+} \}$是边的权重集，
$P = \{p(e) \,|\,  e \in E, p(e) \in (0, 1]\}$是边存在可能性的集合。
\end{definition}

\begin{definition}[蕴含图]
\label{def:2.2}
令不确定图$\mathcal{G} = (V, E, W, P)$，
若确定图$G=(V_G,E_G,W_G)$是$\mathcal{G}$的一个蕴含图，
则必然满足${V_G}=V$，${E_G}\subseteq E$和${W_G}=\{w(e)|e\in {E_G}\}\subseteq W$。
\end{definition}

从定义~\ref{def:2.1}可知，
不确定图$\mathcal{G} = (V, E, W, P)$每条边以$p(e)$的概率存在，
在可能世界模型下，每条边有存在和不存在两种可能性，所以可以派生出$2^{|E|}$个蕴含图。
本文沿用文献[5, 8, 12]对不确定图模型所做的假设，即不确定图中不同边的概率分布相互独立。
将蕴含图$G$和不确定图$\mathcal{G}$之间的关系表示为$\mathcal{G}\Rightarrow G$。
基于以上假设，蕴含图$G$存在的概率为
\begin{equation}
\label{eq:2.1}
\Pr(\mathcal{G} \Rightarrow G) = \prod_{e\in E_G}p(e) \prod_{e\in E\setminus E_G}(1-p(e)).
\end{equation}


记不确定图$\mathcal{G}$的所有蕴含图的集合为$Imp(\mathcal{G})$。
由文献[6]可知$\mathcal{G}$中所有蕴含图出现的概率和为1，即
\begin{equation}
\label{eq:2.2}
\sum\limits_{G\in Imp(\mathcal{G})}{Pr(\mathcal{G}\Rightarrow G)}=1.
\end{equation}

\begin{example}
图~\ref{fig1:subfiga}为一个不确定图$\mathcal{G}_{1}$，
边上的两个数字分别代表权值和概率，
由于该不确定图有五条可能出现的边，因此该不确定图有$2^5$个蕴含图。
图\ref{fig1:subfigb}为不确定图$\mathcal{G}_{1}$的一个蕴含图，
显然该蕴含图存在的概率为$p(e_2)\times p(e_3)\times p(e_4)\times p(e_5)\times (1-p(e_1)))= 0.03528$。
\end{example}

\begin{figure}[htb]
\centering
\label{fig1}
\subfigure[]{
    \label{fig1:subfiga}
    \begin{minipage}[t]{\figwidth}
    \centering
    \includegraphics[width=\figwidth]{Fig1a}
    \end{minipage}}
\subfigure[]{
    \label{fig1:subfigb}
    \begin{minipage}[t]{\figwidth}
    \centering
    \includegraphics[width=\figwidth]{Fig1b}
    \end{minipage}}
\subfigure[]{
    \label{fig1:subfigc}
    \begin{minipage}[t]{\figwidth}
    \centering
    \includegraphics[width=\figwidth]{Fig1c}
    \end{minipage}}
\caption{Example:
(a) uncertain graph $\mathcal{G}_{1}$;
(b) an implicated graph from $\mathcal{G}_{1}$;
(c) main implicated graph from $\mathcal{G}_{1}$.}
\end{figure}

在传统图论中，图的最小生成树被定义为边的权值和最小的生成树，
一个图可能存在多个最小生成树，这些最小生成树具有相同的权值和。
然而在不确定图中，每条边都有一个存在的概率，
这样会导致每一颗最小生成树都只有一定的概率存在，
我们可以通过一个稳定性来区分最小生成树的好坏，即
\begin{equation}
\label{eq:2.3}
R_T = \prod_{e\in E_T}p(e)
\end{equation}

公式~\ref{eq:2.3}的含义与公式~\ref{eq:2.1}有所不同，
公式~\ref{eq:2.3}的另一层含义可以解释为所有包含最小生成树$T$的蕴含图存在的概率和。

为了区分每颗生成树，我们需要给每个生成树进行编号，
假设所有生成树的边都按照编号从小到大进行排序，我们称字典序较小的生成树具有更小的编号。

\begin{definition}[最小生成树]
\label{def:2.3}
设确定图$G=(V,E,W)$，若生成树$T$满足$\forall T'(\sum_{e \in E_T} W(e) \le \sum_{e' \in E_{T'}}W(e'))$，
则称$T$为确定图$G$的最小生成树，记编号最小的最小生成树为$T_M^G$，
其边集为$E_M^G$，边的权值和为$W_M^G$。
\end{definition}

\begin{definition}[最小乘积生成树]
\label{def:2.4}
设确定图$G=(V,E,W)$，若生成树$T$满足$\forall T'(\prod_{e \in E_T} W(e) \le \prod_{e' \in E_{T'}}W(e'))$，
则称$T$为确定图$G$的最小乘积生成树，记编号最小的最小乘积生成树为$T_P^G$，
其边集为$E_P^G$，边的权值和为$W_P^G$。
\end{definition}

\begin{definition}[最优生成树]
\label{def:2.5}
设$Imp(\mathcal{T})$为不确定图$\mathcal{G}$中所有最小生成树的集合，
若最小生成树$T$满足$\forall T' \in Imp(\mathcal{T})(R_{T'} \le R_T)$，
则称$T$为不确定图$\mathcal{G}$的最优生成树。记编号最小的最优生成树为$T_O^{\mathcal{G}}$，
其边集为$E_O^{\mathcal{G}}$，边的权值和为$W_O^{\mathcal{G}}$。
\end{definition}

显然，最优生成树不是唯一的，我们也可以将最优生成树看作不确定图中的最小生成树中的最小乘积生成树。


\section{最优生成树算法}
\label{sec:chap2algorithm}

\begin{theorem}
\label{trm:2.2.1}
设确定图$G=(V,E,W)$和$G'=(V,E,W')$，其满足$W'(e) = \log_2 (W(e))$，
则$W_P^G = 2^{W_M^{G'}}$。
\end{theorem}

\begin{proof}
设$T$为$G$和$G'$的任意一颗生成树，其边集为$E_T$，则$\sum_{e \in E_T}W'(e) = \log_2 \prod_{e \in E_T}W(e)$，
显然生成树$T$在$G'$中的边权和与在$G$中边权的乘积成正比，
当$T$为$G'$的最小生成树时，则有$W_M^{G'} = \log_2 W_P^G$，即$W_P^G = 2^{W_M^{G'}}$。
\end{proof}

由定理~\ref{trm:2.2.1}可知，要想求得最小乘积生成树，
可以将图中所有边的权值进行$\log$变换，然后求新图的最小生成树。
我们将在后面使用该思路去求解不确定图的最优生成树。

我们知道使用$kruskal$算法求解最小生成树的第一步是需要对图中所有的边进行排序，
那么我们也假设不确定图$\mathcal{G} = (V,E,W,P)$中所有的边按照如下优先级进行排序：

\begin{itemize}
 \item 将权值较小的边排在前面；
 \item 对于权值相同的边，则将概率较大的边排在前面；
 \item 若两者的值都相同，则顺序任意。
\end{itemize}

这样，相同权值的边将会在排列在一起，我们假设不同权值的边的数目为$m$，
那么我们可以将边集$E$按照边权值的不同划分为$E'_1, E'_2, \cdots, E'_m$，
在同一个集合内的边具有相同的权值，
且满足$e_1 \in E'_i \land e_2 \in E'_j \land i < j \Rightarrow  W(e_1) < W(e_2)$。
假设$G_1$为$E'_1$在不确定图$\mathcal{G}$中的导出子图，
即边集为$E_{G_1}=E'_1$，顶点集$V_{G_1}$为边集$E_{G_1}$关联的顶点，
定义$\mathcal{G}_1 = \mathcal{G}$，那么我们按照下列步吧成图$G_2, \cdots, G_m$：

\begin{itemize}
 \item 将不确定图$\mathcal{G}_{i-1}$按照顶点集$V_{G_{i-1}}$进行缩点，得到不确定图$\mathcal{G}_i$;
 \item $G_i$则为$E'_i$在不确定图$\mathcal{G}_i$中的导出子图，即边集$E_i$为集合$E'_i$与$\mathcal{G}_i$的边集的交集。
\end{itemize}

\begin{example}
\end{example}
